[toc]
# 数据仓库
- 数据仓库是一个面向主题的（Subject Oriented）、集成的（Integrate）、相对稳定的（Non-Volatile）、反映历史变化（Time Variant）的数据集合，用于支持管理决策。
- 企业需要对不同来源、不同形式、不同主题的数据整合起来，供给数据分析、数据挖掘、数据报表使用时，有这么一个中间层将各种原始数据科学地加工处理成下游需要的样子。**这个中间层就是数据仓库产生价值的地方**




## (总线矩阵)核心概念

### **业务板块**
- 根据业务属性划分出相对独立的业务板块，业务板块是一种**很大的划分**，各个业务板块**重叠度非常低**，**数据独立建设**，比如地产板块、金融板块、医疗板块、电商板块

### **模型设计**
- 以维度建模为理论基础，基于维度建模的总线架构，**构建一致性的维度表和事实表，同时设计出一套命名规范**

### **数据域**
- 数据域是**数仓层的顶层划分**，是一个**较高层次的数据归类标准**，是**对企业的各个业务过程进行抽象、提炼、组合成的集合，面向业务分析**
- 一个数据域对应一个宏观分析领域，例如采购域、供应链域、学生域、老师域、CR域、CC域、排课域
- 数据域是抽象提炼出来的，并且不容易变动，既能涵盖当前所有业务需求，又能在新的业务进入时无影响的将其分配到已有的数据域，只有当前数据域分类都不合适的时候才会扩展到新的数据域
- 数据域的特点是抽象、长期维护和更新、但是不宜变更
> 为保障整个体系的生命力，数据域是需要抽象提炼并且长期维护更新的，但不轻易变动。在划分数据域时，既要能涵盖所有业务需求，又能在新业务进入时无影响的包含已有的数据还要扩展新的数据域。

- 数据域的创建需要经过这样几个流程，第一数据调研(业务调研)，第二业务分类，第三数据域定义(数据域的名称)，第四总线矩阵构建


域名 | 业务过程
---|---
会员域 | 会员注册、登录、退出、冻结、注销
商品域 | 商品发布、上架、下架、属性变更
日志域 | 曝光、点击、浏览、收藏、滑动、搜索


### 业务过程
- 业务过程是企业的业务活动事件，且是企业经营过程中不可拆分的事件，比如下订单、账号注册、银行转账都是业务过程

### 修饰词
- 修饰词指的是出统计指标以外的对指标进行限定抽象的业务场景，修饰词属于一个修饰类型，比如值日志域的访问终端下，有修饰词PC,w无线端、手机端，IOS
- 修饰词的出现是为了方便管理

### 时间周期
- 用来明确数据统计的时间范围或时间点

### 原子指标
- 原子指标是针对某一业务的**行为的度量**，是一种不可拆分的指标，有明确的业务含义，比如支付金额，注册用户数
- 原子指标有确定的字段名称，数据类型，算法说明，所属数据域和业务过程，原子指标一般采用**动作_度量**的方式命名，例如注册学生

### 一致性指标(扩展指标)
- 指标归属到具体的数据域，指标的定义、名称、类型、计算方法，确保指标的全局一致性
- 一致性指标用来描述原子指标、修饰词、时间周期和派生指标的含义、类型、命名、算法，被用于模型设计
- 一致性指标=原子指标+时间修饰词+其他修饰词，例如 最近7天(时间修饰词)支付(其他修饰词)积分，最近1月注册用户数


### 计算方法
- 指标的数学计算公式，比如汇总、平均、最值

### 事实表
- 事实表是观察事物得到的事实数据，事实设计来自业务过程事件的描述，例如一次购买行为
- 事实表是数仓建设的主要产物，数仓绝大部分都是事实表，事实表主要由两部分组成，第一部分主键和外键组成的键值部分，第二部分加事实明细组成，外键通常对应维度表的主键。 


### OLAP

#### ROLAP
- 基于关系型数据库，不需要预计算
- 加快速度的方式主要是使用内存和优化算法(presto,impala)

#### MOALP
- 基于多维数据集，需要预计算，加快速度的方式是预计算
- 一个多维数据集叫做 OLAP CUBE

##### 钻取
- 钻取是改变维的层次，变换分析的粒度。它包括向上钻取（roll up）和向下钻取（drill down）

###### roll up
- roll up是在某一维上将低层次的细节数据概括到高层次的汇总数据，或者减少维数(从小到大)
- 是指自动生成汇总行的分析方法。通过向导的方式，用户可以定义分析因素的汇总行，例如对于各地区各年度的销售情况，可以生成地区与年度的合计行，也可以生成地区或者年度的合计行


###### drill down
- rill down则相反，它从汇总数据深入到细节数据进行观察或增加新维(从大到小)
- 例如，用户分析"各地区、城市的销售情况"时，可以对某一个城市的销售额细分为各个年度的销售额，对某一年度的销售额，可以继续细分为各个季度的销售额。通过钻取的功能，使用户对数据能更深入了解，更容易发现问题，做出正确的决策

## 建模工具
### navicate
#### 利用已有的表进行
![image-20201205185521489](https://kingcall.oss-cn-hangzhou.aliyuncs.com/blog/img/2020/12/05/18:55:22-image-20201205185521489.png)



![image-20201205185540321](https://kingcall.oss-cn-hangzhou.aliyuncs.com/blog/img/2020/12/05/18:55:40-image-20201205185540321.png)

#### 建立新的模型图
![image-20201205185558417](https://kingcall.oss-cn-hangzhou.aliyuncs.com/blog/img/2020/12/05/18:55:58-image-20201205185558417.png)




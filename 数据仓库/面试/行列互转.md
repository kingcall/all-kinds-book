### 行专列

explode() 搭配 lateral view实现



### 列转行



collect_set(col) 会去重

collect_list(col) 不会去重，都返回数组



case when

```
 select  max(case when line='xx' then num end) as `xx`,
      max(case when line='yy' then num end) as `yy`
      from 
(select line,count(*) num from 
tablea
group by line) ta 
```


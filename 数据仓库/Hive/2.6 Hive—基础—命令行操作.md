[TOC]



## Hive 命令行

$HIVE_HOME/bin/hive 是hive 提供的一个交互式终端，其实就是一个shell 脚本，主要用来做交互式查询

但是自从Hive 0.11引入了HiveServer2之后，就引入了另外一个终端，那就是beeline,它是基于JDBC 的SQL 客户端，所以hive 命令终端慢慢的也被弃用

hive-cli是一个遗留工具，它有两个主要的使用场景。第一个是它作为Hadoop上SQL的**重客户端**，第二个是它作为hiveserver(也就是现在说的"HiveServer1")的命令行工具。但是自从hive1.0 开始hiveserver已被弃用并从代码库中删除，并被替换为HiveServer2因此第二个使用场景不再适用。对于第一个使用场景，Beeline提供或应该提供相同的功能，但实现方式与hivecli不同。

本来hive-cli应该被弃用，但是因为hive-cli的广泛使用，所以社区做了基于beeline的新的客户端，这样做的目的是使用hive-cli不需要对现有用户脚本进行任何或最小的更改。因为新的hive-cli某些特性还是使用的是旧的hive-cli，所以你可以在使用如下配置来开启

```
export USE_DEPRECATED_CLI=false
```

### -e

在 -e 参数的加持下，我们可以不用进入hive 的命令行，而是直接使用hive 命令进行数据查询，这个时候sql 就是我们在命令行里输入的SQL，下面我们感受一下

```
hive -e 'select a.foo from pokes a'
```

你也可以在命令行里指定其他hive 的参数

```
hive -e 'select a.foo from pokes a' --hiveconf hive.exec.scratchdir=/opt/my/hive_scratch --hiveconf mapred.reduce.tasks=1
```



### -f

Hive可以运行保存在文件里面的一条或多条的语句，只要用-f参数，一般情况下，保存这些Hive查询语句的文件通常用.q或者.hql后缀名，但是这不是必须的，你也可以保存你想要的后缀名。

```
hive -f /home/my/hive-script.sql
```

### source

```
 hive
hive> source /home/wyp/Documents/test;
```



### set

#### set <key>=<value>

#### reset

#### set -v



### add

Adds one or more files, jars, or archives to the list of resources in the distributed cache. See [Hive Resources](https://cwiki.apache.org/confluence/display/Hive/LanguageManual+Cli#LanguageManualCli-HiveResources) for more information.

```
add FILE[S] <ivyurl> <ivyurl>* 
add JAR[S] <ivyurl> <ivyurl>* 
add ARCHIVE[S]<ivyurl> <ivyurl>*
```



### list



Lists the resources already added to the distributed cache. See [Hive Resources](https://cwiki.apache.org/confluence/display/Hive/LanguageManual+Cli#LanguageManualCli-HiveResources) for more information

Checks whether the given resources are already added to the distributed cache or not. See [Hive Resources](https://cwiki.apache.org/confluence/display/Hive/LanguageManual+Cli#LanguageManualCli-HiveResources) for more information.

```
list FILE[S]
list JAR[S]
list ARCHIVE[S]
```



### delete

As of [Hive 1.2.0](https://issues.apache.org/jira/browse/HIVE-9664), removes the resource(s) which were added using the <ivyurl> from the distributed cache. See [Hive Resources](https://cwiki.apache.org/confluence/display/Hive/LanguageManual+Cli#LanguageManualCli-HiveResources) for more information.

delete FILE[S] <ivyurl> <ivyurl>* 
delete JAR[S] <ivyurl> <ivyurl>* 
delete ARCHIVE[S] <ivyurl> <ivyurl>*

### quit/exit

退出终端



### ！

 Executes a shell command from the Hive shell.

 

### dfs

Executes a dfs command from the Hive shell. 你可以明显的感觉到比你在shell 里面执行快



### compile

 This allows inline Groovy code to be compiled and be used as a UDF (as of Hive [0.13.0](https://issues.apache.org/jira/browse/HIVE-5252)). For a usage example, see [Nov. 2013 Hive Contributors Meetup Presentations – Using Dynamic Compilation with Hive](https://cwiki.apache.org/confluence/download/attachments/27362054/HiveContrib-Nov13-groovy_plus_hive.pptx?version=1&modificationDate=1385171856000&api=v2).